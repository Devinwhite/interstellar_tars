<!doctype html>

<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Tars Control Panel</title>
		<link rel="icon" href="assets/fav.ico">

		<link rel="apple-touch-icon" href="assets/apple-touch-icon.png">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
		<meta name="apple-mobile-web-app-title" content="Tars CTRL" />
		
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
		
		<style>
			body{
				background: #3F5876;
			}
			
			/* .bars-container {
				overflow: hidden;
				padding-top: 100px;
				padding-bottom: 0px;
			}
			.bar {
				width: 10px;
				height: 40px;
				background: #17A2B8;
				border-radius: 0px;
				transition: .1s linear;
				display: inline-block;
			} */

			.controls {
				background-color: rgba(0, 0, 0, 0.1)
			}

			.btn:hover {
				background: #17A2B8;
			}

			.btn-secondary {
				background: #107282;
			}
			
			.btn-secondary:hover {
				background: #107282;
			}

			.btn-square{
				height: 70px;
				min-width: 70px;
			}

			.slider {
				-webkit-appearance: none;
				width: 100%;
				height: 15px;
				border-radius: 5px;  
				background: #e5e5e5;
				outline: none;
				opacity: 0.7;
				-webkit-transition: .2s;
				transition: opacity .2s;
			}

			.slider::-webkit-slider-thumb {
				-webkit-appearance: none;
				appearance: none;
				width: 35px;
				height: 35px;
				border-radius: 50%; 
				background: #17A2B8;
				cursor: pointer;
			}

			.slider::-moz-range-thumb {
				width: 35px;
				height: 35px;
				border-radius: 50%;
				background: #17A2B8;
				cursor: pointer;
			}
		</style>

	</head>
	

	<body class="py-4">
		<div class="container">
			<div>
				<div class="btn-group btn-group-toggle w-100" data-toggle="buttons">
					<label class="btn btn-info btn-lg active" id="clickOff">
						<input type="radio" name="options" id="option1" autocomplete="off" checked> Humor OFF
					</label>
					<label class="btn btn-info btn-lg" id="clickOn">
						<input type="radio" name="options" id="option2" autocomplete="off"> Humor ON
					</label>
				</div>
				<div class="w-100 controls rounded mt-3 text-center p-2">
					<label class="h5 weight-normal text-light">Sound Board</label>
					<div id="soundBoard" class="d-flex align-content-between flex-wrap">
					</div>
				</div>				
				<div class="dropdown w-100 mt-3">
					<button class="w-100 btn btn-info btn-lg dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Play Video
					</button>
					<div id="videoList"  class="dropdown-menu w-100" aria-labelledby="dropdownMenu">						
					</div>
				</div>
				<div id="videoCntrl" style="display:none;" class="controls p-3 rounded-bottom">
					<div class="btn-group w-100" role="group">
						<button type="button" class="btn btn-info btn-lg mt-3 btn-secondary" id="clickVideoPause"><i class="fas fa-pause"></i></button>
						<button type="button" class="btn btn-info btn-lg mt-3 btn-secondary" id="clickVideoPlay"><i class="fas fa-play"></i></button>
						<button type="button" class="btn btn-info btn-lg mt-3 btn-secondary" id="clickVideoStop"><i class="fas fa-stop"></i></button>
					</div>			
				</div>				
				<div class="dropdown w-100 mt-3">
					<button class="w-100 btn btn-info btn-lg dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Play Music
					</button>
					<div class="dropdown-menu w-100" aria-labelledby="dropdownMenu" id="musicList"></div>
				</div>
				<div id="audioCntrl" style="display:none;" class="controls p-3 rounded-bottom">
					<div class="btn-group w-100" role="group">
						<button type="button" class="btn btn-info btn-lg mt-3 btn-secondary" id="clickAudioPause"><i class="fas fa-pause"></i></button>
						<button type="button" class="btn btn-info btn-lg mt-3 btn-secondary" id="clickAudioPlay"><i class="fas fa-play"></i></button>
						<button type="button" class="btn btn-info btn-lg mt-3 btn-secondary" id="clickAudioStop"><i class="fas fa-stop"></i></button>
					</div>					
				</div>
				<button type="button" class="btn btn-info btn-lg w-100 mt-3" id="clickReload">Reload Screen</button>
			</div>
			
			<!-- <center>
				<div class="bars-container">
					<div class="bar" id="bar"></div>
					<div class="bar" id="bar2"></div>
					<div class="bar" id="bar3"></div>
					<div class="bar" id="bar4"></div>
					<div class="bar" id="bar5"></div>
					<div class="bar" id="bar6"></div>
					<div class="bar" id="bar7"></div>
					<div class="bar" id="bar8"></div>
				</div>
			</center> -->
		</div>

		<script src="//cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
		<script src="https://use.fontawesome.com/releases/v5.12.1/js/all.js" data-auto-replace-svg="nest"></script>

		<script>
			$(function() {
				var conn = new WebSocket('ws://'+location.hostname+':8080');
            
				conn.onopen = function(e) {
					console.log("Connection established!");
				};

				conn.onmessage = function(e) {
					data = {};
					if(isJson(e.data)){
						data = JSON.parse(e.data);
					}
					console.log(e.data);
					/* if(e.data == "reload"){
						window.location.reload();
					}else if(data.type){						
						//objects go here
					}else{
						window.location.href = e.data;
					} */
				};


				$.get( "loadFiles.php?folder=mp3/music/&filter=*.mp3",{}, function(rd) {
					$('#musicList').empty();
					$('#musicList').append('<button class="dropdown-item btn-lg w-100 text-center clickMusicPlay" type="button">PLAY ALL</button>');
					$.each(rd, function(index) {
						result = rd[index];
						$('#musicList').append('<div class="dropdown-divider"></div>');
						$('#musicList').append('<button class="dropdown-item btn-lg w-100 text-center clickMusicPlay" type="button">'+result.replace(".mp3", "")+'</button>');
					});
				}, "json");
				
				$.get( "loadFiles.php?folder=mp3/&filter=*.mp3",{}, function(rd) {
					$('#soundBoard').empty();
					i=1;
					$.each(rd, function(index) {
						result = rd[index];
						if(i>1){
							$('#soundBoard').append('<div class="dropdown-divider"></div>');
						}
						$('#soundBoard').append('<button type="button" class="btn btn-info btn-square m-1 clickSoundPlay">'+result.replace(".mp3", "")+'</button>');
						i++;
					});
				}, "json");

				$.get( "loadFiles.php?folder=mp4/&filter=*.mp4",{}, function(rd) {
					$('#videoList').empty();
					i=1;
					$.each(rd, function(index) {
						result = rd[index];
						if(i>1){
							$('#videoList').append('<div class="dropdown-divider"></div>');
						}
						$('#videoList').append('<button class="dropdown-item btn-lg w-100 text-center clickVideoPlay" id="clickVideo" type="button">'+result.replace(".mp4", "")+'</button>');
						i++;
					});
				}, "json");

				$('#clickOn').on('click', function() {
					$.get( "led_on.php",{}, function(rd) {
						//alert("LED TURNED ON");
					}, "json");
				});	
				$('#clickOff').on('click', function() {
					$.get( "led_off.php",{}, function(rd) {
						//alert("LED TURNED OFF");
					}, "json");
				});	
				$('#clickVideoPause').on('click', function() {
					togglePause('#clickVideo', true);
					conn.send('videoPause');
				});
				$('#clickVideoPlay').on('click', function() {
					togglePause('#clickVideo', false);
					conn.send('videoPlay');
				});										
				$('#clickReload, #clickVideoStop').on('click', function() {
					conn.send('reload');
					$('#clickOff').trigger('click');
					$('#audioCntrl').hide();
					$('#videoCntrl').hide();
				});	
				
				$('#videoList').on('click', '.clickVideoPlay', function() {
					togglePause('#clickVideo', false);
					conn.send(JSON.stringify({type:"videoLoad", value:"mp4/"+$(this).text()+".mp4"}));
					$('#videoCntrl').show();
				});
				$('#musicList').on('click', '.clickMusicPlay', function() {
					togglePause('#clickAudio', false);
					conn.send(JSON.stringify({type:"audioLoad", value:"mp3/music/"+$(this).text()+".mp3"}));
					$('#audioCntrl').show();
				});				
				$('#soundBoard').on('click', '.clickSoundPlay', function() {
					conn.send(JSON.stringify({type:"audioLoad", value:"mp3/"+$(this).text()+".mp3"}));
				});				
				$('#clickAudioPause').on('click', function() {
					togglePause('#clickAudio', true);
					conn.send('audioPause');
				});
				$('#clickAudioPlay').on('click', function() {
					togglePause('#clickAudio', false);
					conn.send('audioPlay');
				});
				$('#clickAudioStop').on('click', function() {
					conn.send('audioStop');
					$('#audioCntrl').hide();
				});	

				$('#clickAudioPlay').hide();
				$('#clickVideoPlay').hide();
				
			});

			function togglePause(type, pause){
				button1 = pause?type+"Pause":type+"Play";
				button2 = pause?type+"Play":type+"Pause";
				$(button1).hide();
				$(button2).show();
			}

			function isJson(str) {
				try {
					JSON.parse(str);
				} catch (e) {
					return false;
				}
				return true;
			}

			/* function scaleanim() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim, 100);

			function scaleanim2() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar2").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim2, 100);

			function scaleanim3() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar3").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim3, 100);

			function scaleanim4() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar4").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim4, 100);

			function scaleanim5() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar5").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim5, 100);

			function scaleanim6() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar6").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim6, 100);

			function scaleanim7() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar7").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim7, 100);

			function scaleanim8() {
				var randno;
				randno = Math.random() * (3 - 1.5 + 1.5) + 1.5;
				document.getElementById("bar8").style.transform = "scaleY(" + randno + ")";
			}

			setInterval(scaleanim8, 100); */
		</script>


	</body>

</html>

